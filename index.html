<script>
    // Note: seoTips is no longer a global variable for pre-loaded data,
    // as fetchSEOData will be called directly in generateSEO.
    // However, the dark mode and UI language setup still rely on DOMContentLoaded.

    // Translations object (this remains the same from our last update)
    const translations = {
      en: {
        darkModeButton: 'ЁЯМЩ Dark Mode',
        lightModeButton: 'тШАя╕П Light Mode',
        tagline: 'Smart SEO. More Views. Less Hassle.',
        videoTopicLabel: 'ЁЯУЭ Video Topic/Script',
        videoTopicPlaceholder: 'e.g. A story about a lion who learns humility...',
        contentLanguageLabel: 'ЁЯМН Language',
        englishOption: 'English',
        hindiOption: 'Hindi',
        urduOption: 'Urdu',
        russianOption: 'Russian',
        videoFormatLabel: 'ЁЯОм Video Format',
        shortVideoOption: 'Short Video',
        longVideoOption: 'Long Video',
        generateSEOButton: 'тЪб Generate SEO',
        resetButton: 'ЁЯФБ Reset',
        exportButton: 'ЁЯУе Export',
        titleLabel: 'ЁЯОп Title',
        titlePlaceholder: 'Your optimized title will appear here...',
        copyTitleButton: 'Copy Title',
        descriptionLabel: 'ЁЯУЭ Description',
        descriptionPlaceholder: 'Your SEO description will appear here...',
        hashtagsLabel: 'ЁЯУМ Hashtags',
        hashtagsPlaceholder: 'Relevant hashtags will appear here...',
        videoTagsLabel: 'ЁЯФЦ Video Tags',
        videoTagsPlaceholder: 'Optimized tags will appear here...',
        copyTagsButton: 'Copy Tags',
        copyHashtagsButton: 'Copy Hashtags',
        footerText: 'Powered by <strong>YTSEO.ai</strong> тАУ Built with тЭдя╕П for global creators',
        alertEnterTopic: 'Please enter a video topic first!',
        alertGenerateContent: 'Generate some content first!',
        copiedSuccess: 'тЬУ Copied!',
      },
      hi: {
        darkModeButton: 'ЁЯМЩ рдбрд╛рд░реНрдХ рдореЛрдб',
        lightModeButton: 'тШАя╕П рд▓рд╛рдЗрдЯ рдореЛрдб',
        tagline: 'рд╕реНрдорд╛рд░реНрдЯ рдПрд╕рдИрдУред рдЕрдзрд┐рдХ рд╡реНрдпреВрдЬред рдХрдо рдкрд░реЗрд╢рд╛рдиреАред',
        videoTopicLabel: 'ЁЯУЭ рд╡реАрдбрд┐рдпреЛ рд╡рд┐рд╖рдп/рд╕реНрдХреНрд░рд┐рдкреНрдЯ',
        videoTopicPlaceholder: 'рдЙрджрд╛. рдПрдХ рд╢реЗрд░ рдХреА рдХрд╣рд╛рдиреА рдЬреЛ рд╡рд┐рдирдореНрд░рддрд╛ рд╕реАрдЦрддрд╛ рд╣реИ...',
        contentLanguageLabel: 'ЁЯМН рднрд╛рд╖рд╛',
        englishOption: 'рдЕрдВрдЧреНрд░реЗрдЬреА',
        hindiOption: 'рд╣рд┐рдиреНрджреА',
        urduOption: '╪з╪▒╪п┘И',
        russianOption: 'рд░реВрд╕реА',
        videoFormatLabel: 'ЁЯОм рд╡реАрдбрд┐рдпреЛ рдкреНрд░рд╛рд░реВрдк',
        shortVideoOption: 'рдЫреЛрдЯрд╛ рд╡реАрдбрд┐рдпреЛ',
        longVideoOption: 'рд▓рдВрдмрд╛ рд╡реАрдбрд┐рдпреЛ',
        generateSEOButton: 'тЪб рдПрд╕рдИрдУ рдЬрдирд░реЗрдЯ рдХрд░реЗрдВ',
        resetButton: 'ЁЯФБ рд░реАрд╕реЗрдЯ рдХрд░реЗрдВ',
        exportButton: 'ЁЯУе рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВ',
        titleLabel: 'ЁЯОп рд╢реАрд░реНрд╖рдХ',
        titlePlaceholder: 'рдЖрдкрдХрд╛ рдЕрдиреБрдХреВрд▓рд┐рдд рд╢реАрд░реНрд╖рдХ рдпрд╣рд╛рдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛...',
        copyTitleButton: 'рд╢реАрд░реНрд╖рдХ рдХреЙрдкреА рдХрд░реЗрдВ',
        descriptionLabel: 'ЁЯУЭ рд╡рд┐рд╡рд░рдг',
        descriptionPlaceholder: 'рдЖрдкрдХрд╛ рдПрд╕рдИрдУ рд╡рд┐рд╡рд░рдг рдпрд╣рд╛рдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛...',
        hashtagsLabel: 'ЁЯУМ рд╣реИрд╢рдЯреИрдЧ',
        hashtagsPlaceholder: 'рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╣реИрд╢рдЯреИрдЧ рдпрд╣рд╛рдВ рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗ...',
        videoTagsLabel: 'ЁЯФЦ рд╡реАрдбрд┐рдпреЛ рдЯреИрдЧ',
        videoTagsPlaceholder: 'рдЕрдиреБрдХреВрд▓рд┐рдд рдЯреИрдЧ рдпрд╣рд╛рдВ рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗ...',
        copyTagsButton: 'рдЯреИрдЧ рдХреЙрдкреА рдХрд░реЗрдВ',
        copyHashtagsButton: 'рд╣реИрд╢рдЯреИрдЧ рдХреЙрдкреА рдХрд░реЗрдВ',
        footerText: '<strong>YTSEO.ai</strong> рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд тАУ рд╡реИрд╢реНрд╡рд┐рдХ рд░рдЪрдирд╛рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП тЭдя╕П рд╕реЗ рдирд┐рд░реНрдорд┐рдд',
        alertEnterTopic: 'рдХреГрдкрдпрд╛ рдкрд╣рд▓реЗ рдПрдХ рд╡реАрдбрд┐рдпреЛ рд╡рд┐рд╖рдп рджрд░реНрдЬ рдХрд░реЗрдВ!',
        alertGenerateContent: 'рдкрд╣рд▓реЗ рдХреБрдЫ рд╕рд╛рдордЧреНрд░реА рдЬрдирд░реЗрдЯ рдХрд░реЗрдВ!',
        copiedSuccess: 'тЬУ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЧрдпрд╛!',
      },
      ur: {
        darkModeButton: 'ЁЯМЩ ┌И╪з╪▒┌й ┘Е┘И┌И',
        lightModeButton: 'тШАя╕П ┘Д╪з╪ж┘╣ ┘Е┘И┌И',
        tagline: '╪│┘Е╪з╪▒┘╣ ╪з█М╪│ ╪з█М ╪з┘И█Ф ┘Е╪▓█М╪п ╪в╪▒╪з╪б█Ф ┌й┘Е ┘╛╪▒█М╪┤╪з┘Ж█М█Ф',
        videoTopicLabel: 'ЁЯУЭ ┘И█М┌И█М┘И ┌й╪з ┘Е┘И╪╢┘И╪╣/╪з╪│┌й╪▒┘╛┘╣',
        videoTopicPlaceholder: '┘Е╪л╪з┘Д ┌й█Т ╪╖┘И╪▒ ┘╛╪▒: ╪з█М┌й ╪┤█М╪▒ ┌й█М ┌й█Б╪з┘Ж█М ╪м┘И ╪╣╪з╪м╪▓█М ╪│█М┌й┌╛╪к╪з █Б█Т...',
        contentLanguageLabel: 'ЁЯМН ╪▓╪и╪з┘Ж',
        englishOption: '╪з┘Ж┌п╪▒█М╪▓█М',
        hindiOption: '█Б┘Ж╪п█М',
        urduOption: '╪з╪▒╪п┘И',
        russianOption: '╪▒┘И╪│█М',
        videoFormatLabel: 'ЁЯОм ┘И█М┌И█М┘И ┘Б╪з╪▒┘Е█М┘╣',
        shortVideoOption: '┘Е╪о╪к╪╡╪▒ ┘И█М┌И█М┘И',
        longVideoOption: '╪╖┘И█М┘Д ┘И█М┌И█М┘И',
        generateSEOButton: 'тЪб ╪з█М╪│ ╪з█М ╪з┘И ╪и┘Ж╪з╪ж█М┌║',
        resetButton: 'ЁЯФБ ╪▒█М ╪│█М┘╣ ┌й╪▒█М┌║',
        exportButton: 'ЁЯУе ╪з█М┌й╪│┘╛┘И╪▒┘╣ ┌й╪▒█М┌║',
        titleLabel: 'ЁЯОп ╪╣┘Ж┘И╪з┘Ж',
        titlePlaceholder: '╪в┘╛ ┌й╪з ╪и█Б╪к╪▒ ┌й╪▒╪п█Б ╪╣┘Ж┘И╪з┘Ж █М█Б╪з┌║ ╪╕╪з█Б╪▒ █Б┘И┌п╪з...',
        copyTitleButton: '╪╣┘Ж┘И╪з┘Ж ┌й╪з┘╛█М ┌й╪▒█М┌║',
        descriptionLabel: 'ЁЯУЭ ╪к┘Б╪╡█М┘Д',
        descriptionPlaceholder: '╪в┘╛ ┌й╪з ╪з█М╪│ ╪з█М ╪з┘И ╪к┘Б╪╡█М┘Д █М█Б╪з┌║ ╪╕╪з█Б╪▒ █Б┘И┌п╪з...',
        hashtagsLabel: 'ЁЯУМ █Б█М╪┤ ┘╣█М┌п╪▓',
        hashtagsPlaceholder: '┘Е╪к╪╣┘Д┘В█Б █Б█М╪┤ ┘╣█М┌п╪▓ █М█Б╪з┌║ ╪╕╪з█Б╪▒ █Б┘И┌║ ┌п█Т...',
        videoTagsLabel: 'ЁЯФЦ ┘И█М┌И█М┘И ┘╣█М┌п╪▓',
        videoTagsPlaceholder: '╪и█Б╪к╪▒ ┌й╪▒╪п█Б ┘╣█М┌п╪▓ █М█Б╪з┌║ ╪╕╪з█Б╪▒ █Б┘И┌║ ┌п█Т...',
        copyTagsButton: '┘╣█М┌п╪▓ ┌й╪з┘╛█М ┌й╪▒█М┌║',
        copyHashtagsButton: '█Б█М╪┤ ┘╣█М┌п╪▓ ┌й╪з┘╛█М ┌й╪▒█М┌║',
        footerText: '<strong>YTSEO.ai</strong> ┌й█Т ╪░╪▒█М╪╣█Т ╪к┘В┘И█М╪к █М╪з┘Б╪к█Б тАУ ╪╣╪з┘Д┘Е█М ╪к╪о┘Д█М┘В ┌й╪з╪▒┘И┌║ ┌й█Т ┘Д█М█Т тЭдя╕П ╪│█Т ╪и┘Ж╪з█М╪з ┌п█М╪з',
        alertEnterTopic: '╪и╪▒╪з█Б ┌й╪▒┘Е ┘╛█Б┘Д█Т ╪з█М┌й ┘И█М┌И█М┘И ┌й╪з ┘Е┘И╪╢┘И╪╣ ╪п╪▒╪м ┌й╪▒█М┌║!',
        alertGenerateContent: '┘╛█Б┘Д█Т ┌й┌Ж┌╛ ┘Е┘И╪з╪п ╪и┘Ж╪з╪ж█М┌║!',
        copiedSuccess: 'тЬУ ┌й╪з┘╛█М ┌й█М╪з ┌п█М╪з!',
      },
      ru: {
        darkModeButton: 'ЁЯМЩ ╨в╨╡╨╝╨╜╤Л╨╣ ╤А╨╡╨╢╨╕╨╝',
        lightModeButton: 'тШАя╕П ╨б╨▓╨╡╤В╨╗╤Л╨╣ ╤А╨╡╨╢╨╕╨╝',
        tagline: '╨г╨╝╨╜╨╛╨╡ SEO. ╨С╨╛╨╗╤М╤И╨╡ ╨┐╤А╨╛╤Б╨╝╨╛╤В╤А╨╛╨▓. ╨Ь╨╡╨╜╤М╤И╨╡ ╤Е╨╗╨╛╨┐╨╛╤В.',
        videoTopicLabel: 'ЁЯУЭ ╨в╨╡╨╝╨░ ╨▓╨╕╨┤╨╡╨╛/╨б╤Ж╨╡╨╜╨░╤А╨╕╨╣',
        videoTopicPlaceholder: '╨Э╨░╨┐╤А╨╕╨╝╨╡╤А: ╨Ш╤Б╤В╨╛╤А╨╕╤П ╨╛ ╨╗╤М╨▓╨╡, ╨║╨╛╤В╨╛╤А╤Л╨╣ ╤Г╤З╨╕╤В╤Б╤П ╤Б╨║╤А╨╛╨╝╨╜╨╛╤Б╤В╨╕...',
        contentLanguageLabel: 'ЁЯМН ╨п╨╖╤Л╨║',
        englishOption: '╨Р╨╜╨│╨╗╨╕╨╣╤Б╨║╨╕╨╣',
        hindiOption: '╨е╨╕╨╜╨┤╨╕',
        urduOption: '╨г╤А╨┤╤Г',
        russianOption: '╨а╤Г╤Б╤Б╨║╨╕╨╣',
        videoFormatLabel: 'ЁЯОм ╨д╨╛╤А╨╝╨░╤В ╨▓╨╕╨┤╨╡╨╛',
        shortVideoOption: '╨Ъ╨╛╤А╨╛╤В╨║╨╛╨╡ ╨▓╨╕╨┤╨╡╨╛',
        longVideoOption: '╨Ф╨╗╨╕╨╜╨╜╨╛╨╡ ╨▓╨╕╨┤╨╡╨╛',
        generateSEOButton: 'тЪб ╨б╨╛╨╖╨┤╨░╤В╤М SEO',
        resetButton: 'ЁЯФБ ╨б╨▒╤А╨╛╤Б╨╕╤В╤М',
        exportButton: 'ЁЯУе ╨н╨║╤Б╨┐╨╛╤А╤В',
        titleLabel: 'ЁЯОп ╨Ч╨░╨│╨╛╨╗╨╛╨▓╨╛╨║',
        titlePlaceholder: '╨Т╨░╤И ╨╛╨┐╤В╨╕╨╝╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╨╜╤Л╨╣ ╨╖╨░╨│╨╛╨╗╨╛╨▓╨╛╨║ ╨┐╨╛╤П╨▓╨╕╤В╤Б╤П ╨╖╨┤╨╡╤Б╤М...',
        copyTitleButton: '╨Ъ╨╛╨┐╨╕╤А╨╛╨▓╨░╤В╤М ╨╖╨░╨│╨╛╨╗╨╛╨▓╨╛╨║',
        descriptionLabel: 'ЁЯУЭ ╨Ю╨┐╨╕╤Б╨░╨╜╨╕╨╡',
        descriptionPlaceholder: '╨Т╨░╤И╨╡ SEO-╨╛╨┐╨╕╤Б╨░╨╜╨╕╨╡ ╨┐╨╛╤П╨▓╨╕╤В╤Б╤П ╨╖╨┤╨╡╤Б╤М...',
        hashtagsLabel: 'ЁЯУМ ╨е╤Н╤И╤В╨╡╨│╨╕',
        hashtagsPlaceholder: '╨б╨╛╨╛╤В╨▓╨╡╤В╤Б╤В╨▓╤Г╤О╤Й╨╕╨╡ ╤Е╤Н╤И╤В╨╡╨│╨╕ ╨┐╨╛╤П╨▓╤П╤В╤Б╤П ╨╖╨┤╨╡╤Б╤М...',
        videoTagsLabel: 'ЁЯФЦ ╨в╨╡╨│╨╕ ╨▓╨╕╨┤╨╡╨╛',
        videoTagsPlaceholder: '╨Ю╨┐╤В╨╕╨╝╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╨╜╤Л╨╡ ╤В╨╡╨│╨╕ ╨┐╨╛╤П╨▓╤П╤В╤Б╤П ╨╖╨┤╨╡╤Б╤М...',
        copyTagsButton: '╨Ъ╨╛╨┐╨╕╤А╨╛╨▓╨░╤В╤М ╤В╨╡╨│╨╕',
        copyHashtagsButton: '╨Ъ╨╛╨┐╨╕╤А╨╛╨▓╨░╤В╤М ╤Е╤Н╤И╤В╨╡╨│╨╕',
        footerText: '╨а╨░╨▒╨╛╤В╨░╨╡╤В ╨╜╨░ <strong>YTSEO.ai</strong> тАУ ╨б╨╛╨╖╨┤╨░╨╜╨╛ ╤Б тЭдя╕П ╨┤╨╗╤П ╨│╨╗╨╛╨▒╨░╨╗╤М╨╜╤Л╤Е ╨░╨▓╤В╨╛╤А╨╛╨▓',
        alertEnterTopic: '╨Я╨╛╨╢╨░╨╗╤Г╨╣╤Б╤В╨░, ╤Б╨╜╨░╤З╨░╨╗╨░ ╨▓╨▓╨╡╨┤╨╕╤В╨╡ ╤В╨╡╨╝╤Г ╨▓╨╕╨┤╨╡╨╛!',
        alertGenerateContent: '╨б╨╜╨░╤З╨░╨╗╨░ ╤Б╨│╨╡╨╜╨╡╤А╨╕╤А╤Г╨╣╤В╨╡ ╨║╨░╨║╨╛╨╣-╨╗╨╕╨▒╨╛ ╨║╨╛╨╜╤В╨╡╨╜╤В!',
        copiedSuccess: 'тЬУ ╨б╨║╨╛╨┐╨╕╤А╨╛╨▓╨░╨╜╨╛!',
      }
    };

    function applyTranslations(lang) {
      document.querySelectorAll('[data-translate-key]').forEach(element => {
        const key = element.getAttribute('data-translate-key');
        if (translations[lang] && translations[lang][key]) {
          if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
            element.placeholder = translations[lang][key];
          } else if (element.tagName === 'OPTION') {
            element.textContent = translations[lang][key];
          } else if (element.tagName === 'BUTTON' && (key === 'darkModeButton' || key === 'lightModeButton')) {
            element.innerHTML = document.body.classList.contains("dark") ? translations[lang].lightModeButton : translations[lang].darkModeButton;
          } else {
            element.textContent = translations[lang][key];
          }
        }
      });
      const darkModeBtn = document.querySelector('[onclick="toggleDarkMode()"]');
      if (darkModeBtn) {
        darkModeBtn.textContent = document.body.classList.contains("dark") ? translations[lang].lightModeButton : translations[lang].darkModeButton;
      }
    }

    function changeUILanguage() {
      const lang = document.getElementById("uiLang").value;
      localStorage.setItem('ytseoUILang', lang);
      applyTranslations(lang);
    }

    // Copy to Clipboard
    function copyToClipboard(id) {
        const textarea = document.getElementById(id);
        textarea.select();
        document.execCommand("copy");

        const btn = document.querySelector(`[onclick="copyToClipboard('${id}')"]`);
        const originalText = btn.textContent;
        const currentLang = localStorage.getItem('ytseoUILang') || 'en';
        btn.textContent = translations[currentLang].copiedSuccess;
        setTimeout(() => {
            btn.textContent = originalText;
        }, 2000);
    }

    // --- ENHANCED JAVASCRIPT PROCESSOR (from DeepSeek's latest suggestion) ---

    // Improved content generator
    async function generateSEO() {
        const topic = document.getElementById("inputTopic").value.trim();
        const lang = document.getElementById("language").value; // Content language, not UI
        const isShort = document.getElementById("type").value === "shorts";
        const type = isShort ? "shorts" : "long";
        const currentUILang = localStorage.getItem('ytseoUILang') || 'en'; // UI language for alerts

        if (!topic) {
            alert(translations[currentUILang].alertEnterTopic);
            return;
        }

        // Load templates
        const { seo_templates, fallback } = await fetchSEOData();
        
        // Find best matching template
        const template = findBestTemplate(topic, seo_templates);
        
        // Use the found template, or the fallback if no specific template is found
        const chosenTemplate = template || fallback;

        // Generate variables (topic, language, type are always available)
        const variables = {
            topic,
            language: lang,
            type: isShort ? "short" : "long video", // Provide a more descriptive 'type' for fallback
            ...(chosenTemplate.variables || {}) // Merge template-specific variables if they exist
        };

        // Apply templates and populate textareas
        document.getElementById("titleBox").value = replacePlaceholders(
            chosenTemplate.templates ? chosenTemplate.templates.title[type] : chosenTemplate.title,
            variables
        );
        
        document.getElementById("descBox").value = replacePlaceholders(
            chosenTemplate.templates ? chosenTemplate.templates.description[type] : chosenTemplate.description,
            variables
        );
        
        const tagsRaw = replacePlaceholders(
            chosenTemplate.templates ? chosenTemplate.templates.tags.join(", ") : chosenTemplate.tags.join(", "),
            variables
        );
        document.getElementById("tagsBox").value = tagsRaw;
        document.getElementById("hashtagBox").value = tagsRaw.split(", ").map(t => `#${t.replace(/\s+/g, '')}`).join(" ");
    }

    // Helper functions (from DeepSeek's latest suggestion)
    async function fetchSEOData() {
        try {
            const response = await fetch('seo-data.json');
            if (!response.ok) {
                // If the file is not found or other network error, log and return empty structure
                console.error('Failed to load seo-data.json. Check file path and content.');
                return { seo_templates: [], fallback: {} };
            }
            return await response.json();
        } catch (error) {
            console.error('Error parsing seo-data.json:', error);
            return { seo_templates: [], fallback: {} }; // Return empty structure on parse error
        }
    }

    function findBestTemplate(topic, templates) {
        const lowerTopic = topic.toLowerCase();
        // Finds the first template where any of its keywords match (includes) the topic
        return templates.find(t => 
            t.keywords.some(kw => lowerTopic.includes(kw.toLowerCase()))
        );
    }

    function replacePlaceholders(text, variables) {
        if (!text) return ""; // Handle cases where text might be undefined
        return text.replace(/{(\w+)}/g, (_, key) => {
            const options = variables[key];
            // If options is an array, pick a random one; otherwise, use the value directly
            return Array.isArray(options) 
                ? options[Math.floor(Math.random() * options.length)]
                : (options !== undefined ? options : ""); // Use empty string if variable is undefined
        });
    }

    // --- END OF ENHANCED JAVASCRIPT PROCESSOR ---


    // Reset Form
    function resetFields() {
      document.getElementById("inputTopic").value = "";
      document.getElementById("language").selectedIndex = 0;
      document.getElementById("type").selectedIndex = 0;
      document.getElementById("titleBox").value = "";
      document.getElementById("descBox").value = "";
      document.getElementById("hashtagBox").value = "";
      document.getElementById("tagsBox").value = "";
    }

    // Download as TXT
    function downloadTxt() {
      const title = document.getElementById("titleBox").value;
      const desc = document.getElementById("descBox").value;
      const tags = document.getElementById("tagsBox").value;
      const hashtags = document.getElementById("hashtagBox").value;
      const currentLang = localStorage.getItem('ytseoUILang') || 'en';

      if (!title && !desc && !tags && !hashtags) {
        alert(translations[currentUILang].alertGenerateContent);
        return;
      }

      const content = `Title:\n${title}\n\nDescription:\n${desc}\n\nTags:\n${tags}\n\nHashtags:\n${hashtags}`;
      const blob = new Blob([content], { type: "text/plain" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "ytseo-ai-content.txt";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    // Dark Mode Toggle
    function toggleDarkMode() {
      document.body.classList.toggle("dark");
      const btn = document.querySelector('[onclick="toggleDarkMode()"]');
      const currentLang = localStorage.getItem('ytseoUILang') || 'en';
      btn.textContent = document.body.classList.contains("dark") ? translations[currentLang].lightModeButton : translations[currentLang].darkModeButton;
      localStorage.setItem('ytseoDarkMode', document.body.classList.contains("dark"));
    }

    // INITIALIZE ON LOAD (Keep this as it handles UI language and Dark Mode)
    document.addEventListener('DOMContentLoaded', async () => {
        // Apply UI language and dark mode first
        const savedLang = localStorage.getItem('ytseoUILang') || 'en';
        document.getElementById('uiLang').value = savedLang;
        applyTranslations(savedLang);

        if (localStorage.getItem('ytseoDarkMode') === 'true') {
            document.body.classList.add('dark');
            const btn = document.querySelector('[onclick="toggleDarkMode()"]');
            const currentLang = localStorage.getItem('ytseoUILang') || 'en';
            btn.textContent = translations[currentLang].lightModeButton;
        }
    });
</script>
