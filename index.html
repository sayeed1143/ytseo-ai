<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube SEO Generator</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f4; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1, h2 { color: #0056b3; }
        label { margin-right: 10px; font-weight: bold; }
        select, button { padding: 8px 12px; margin-bottom: 10px; border-radius: 4px; border: 1px solid #ccc; }
        button { background-color: #007bff; color: white; cursor: pointer; border: none; }
        button:hover { background-color: #0056b3; }
        .output-section { background-color: #e9e9e9; padding: 15px; border-radius: 5px; margin-top: 20px; }
        .output-section p { margin: 5px 0; }
        .output-section strong { color: #333; }
        #generatedTags { word-wrap: break-word; } /* For long tag lists */
    </style>
</head>
<body>
    <div class="container">
        <h1>YouTube SEO Generator</h1>

        <div>
            <label for="languageSelect">Select Language:</label>
            <select id="languageSelect">
                </select>
            
            <label for="nicheSelect">Select Niche:</label>
            <select id="nicheSelect">
                 </select>

            <button id="generateBtn">Generate SEO</button>
        </div>

        <div class="output-section">
            <h2>Generated SEO:</h2>
            <p><strong>Title:</strong> <span id="generatedTitle"></span></p>
            <p><strong>Description:</strong> <span id="generatedDescription"></span></p>
            <p><strong>Tags:</strong> <span id="generatedTags"></span></p>
        </div>
    </div>

    <script>
        const languageSelect = document.getElementById('languageSelect');
        const nicheSelect = document.getElementById('nicheSelect');
        const generateBtn = document.getElementById('generateBtn');
        const generatedTitle = document.getElementById('generatedTitle');
        const generatedDescription = document.getElementById('generatedDescription');
        const generatedTags = document.getElementById('generatedTags');

        let seoData = {}; // To store the fetched JSON data

        // Function to load languages and niches into dropdowns
        function loadUIElements() {
            // Populate language select
            for (const langCode in seoData.languages) {
                const option = document.createElement('option');
                option.value = langCode;
                option.textContent = seoData.languages[langCode];
                languageSelect.appendChild(option);
            }
            // Set default language
            languageSelect.value = 'en'; 

            // Populate niche select
            for (const niche in seoData.seo_templates) {
                const option = document.createElement('option');
                option.value = niche;
                option.textContent = niche.replace(/_/g, ' ').replace(/\b\w/g, char => char.toUpperCase()); // Format for display
                nicheSelect.appendChild(option);
            }
        }

        // Function to generate SEO content
        function generateSEO() {
            const selectedLang = languageSelect.value;
            const selectedNiche = nicheSelect.value;

            if (!selectedLang || !selectedNiche) {
                alert("Please select both a language and a niche.");
                return;
            }

            const nicheTemplates = seoData.seo_templates[selectedNiche];
            if (!nicheTemplates || nicheTemplates.length === 0) {
                console.warn(`No templates found for niche: ${selectedNiche}. Using fallback.`);
                useFallback(selectedLang);
                return;
            }

            // Pick a random template from the selected niche
            const randomTemplate = nicheTemplates[Math.floor(Math.random() * nicheTemplates.length)];

            // Get the language-specific title, description, and tags
            let title = randomTemplate.templates.title[selectedLang];
            let description = randomTemplate.templates.description[selectedLang];
            let tags = randomTemplate.templates.tags[selectedLang]; // This is already an array

            // If the template has specific variables, replace them
            if (randomTemplate.variables) {
                const templateVariables = randomTemplate.variables;

                for (const varName in templateVariables) {
                    if (templateVariables.hasOwnProperty(varName)) {
                        const varValues = templateVariables[varName][selectedLang]; // Get language-specific values
                        if (varValues && varValues.length > 0) {
                            const randomVarValue = varValues[Math.floor(Math.random() * varValues.length)];
                            const placeholder = new RegExp(`{${varName}}`, 'g');

                            title = title.replace(placeholder, randomVarValue);
                            description = description.replace(placeholder, randomVarValue);
                            tags = tags.map(tag => tag.replace(placeholder, randomVarValue));
                        } else {
                            console.warn(`No values found for variable '${varName}' in language '${selectedLang}' for niche '${selectedNiche}'.`);
                        }
                    }
                }
            }

            generatedTitle.textContent = title;
            generatedDescription.textContent = description;
            generatedTags.textContent = tags.join(", "); // Display tags as comma-separated string
        }

        // Function to use fallback content if no niche template is found
        function useFallback(lang) {
            const fallback = seoData.fallback;
            if (!fallback) {
                console.error("Fallback data not found in JSON.");
                generatedTitle.textContent = "Error generating SEO.";
                generatedDescription.textContent = "Error generating SEO.";
                generatedTags.textContent = "Error generating SEO.";
                return;
            }

            let title = fallback.templates.title[lang] || fallback.templates.title.en; // Fallback to English if chosen lang not found
            let description = fallback.templates.description[lang] || fallback.templates.description.en;
            let tags = fallback.templates.tags[lang] || fallback.templates.tags.en;

            if (fallback.variables) {
                for (const varName in fallback.variables) {
                    if (fallback.variables.hasOwnProperty(varName)) {
                        const varValues = fallback.variables[varName][lang] || fallback.variables[varName].en;
                        if (varValues && varValues.length > 0) {
                            const randomVarValue = varValues[Math.floor(Math.random() * varValues.length)];
                            const placeholder = new RegExp(`{${varName}_${lang}}|{${varName}}`, 'g'); // Try both explicit and generic placeholder
                            
                            // Important: Fallback placeholders should match the template, e.g., {topic_en} or {topic}
                            // In this fallback, I've used {topic_en} for clarity, but if your templates are just {topic}, adjust the regex.
                            // The JSON provided above uses {topic_en} etc for fallback for explicit language, so this matches.
                            
                            title = title.replace(new RegExp(`{${varName}_${lang}}`, 'g'), randomVarValue);
                            description = description.replace(new RegExp(`{${varName}_${lang}}`, 'g'), randomVarValue);
                            tags = tags.map(tag => tag.replace(new RegExp(`{${varName}_${lang}}`, 'g'), randomVarValue));

                            // Also try to replace generic placeholders if they exist
                            title = title.replace(new RegExp(`{${varName}}`, 'g'), randomVarValue);
                            description = description.replace(new RegExp(`{${varName}}`, 'g'), randomVarValue);
                            tags = tags.map(tag => tag.replace(new RegExp(`{${varName}}`, 'g'), randomVarValue));
                        }
                    }
                }
            }

            // For the fallback, we need to supply *some* generic topics/video types
            // This is a manual override for the fallback to ensure it always produces something
            // In a real app, you might have user input for topic, or default to a generic one.
            const genericTopic = {
                en: "General Topic", hi: "सामान्य विषय", ur: "عام موضوع", ru: "Общая тема", es: "Tema General", fr: "Sujet Général", nl: "Algemeen Onderwerp"
            }[lang] || "General Topic";
            
            const genericVideoType = {
                en: "Video", hi: "वीडियो", ur: "ویڈیو", ru: "Видео", es: "Video", fr: "Vidéo", nl: "Video"
            }[lang] || "Video";

            title = title.replace(/{topic_en}|{topic}/g, genericTopic); // Replace generic topic placeholders too
            description = description.replace(/{topic_en}|{topic}/g, genericTopic);
            tags = tags.map(tag => tag.replace(/{topic_en}|{topic}/g, genericTopic));

            title = title.replace(/{video_type_en}|{video_type}/g, genericVideoType); // Replace generic video_type placeholders too
            description = description.replace(/{video_type_en}|{video_type}/g, genericVideoType);
            tags = tags.map(tag => tag.replace(/{video_type_en}|{video_type}/g, genericVideoType));


            generatedTitle.textContent = title;
            generatedDescription.textContent = description;
            generatedTags.textContent = tags.join(", ");
        }


        // Event Listeners
        generateBtn.addEventListener('click', generateSEO);

        // Fetch the JSON data when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            fetch("seo-templates.json")
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status} - Could not load seo-templates.json. Make sure you are running a local server.`);
                    }
                    return response.json();
                })
                .then(data => {
                    seoData = data; // Store the data globally
                    loadUIElements(); // Populate dropdowns
                    generateSEO(); // Generate initial SEO on load
                })
                .catch(error => {
                    console.error("Error fetching or processing SEO templates:", error);
                    generatedTitle.textContent = "Error: Could not load data.";
                    generatedDescription.textContent = "Please ensure 'seo-templates.json' is in the correct path and your environment supports fetching local files (e.g., using a local server).";
                    generatedTags.textContent = "";
                });
        });

    </script>
</body>
</html>
