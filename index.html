<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube SEO Generator</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f4; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1, h2 { color: #0056b3; }
        label { margin-right: 10px; font-weight: bold; }
        select, button { padding: 8px 12px; margin-bottom: 10px; border-radius: 4px; border: 1px solid #ccc; }
        button { background-color: #007bff; color: white; cursor: pointer; border: none; }
        button:hover { background-color: #0056b3; }
        .output-section { background-color: #e9e9e9; padding: 15px; border-radius: 5px; margin-top: 20px; }
        .output-section p { margin: 5px 0; }
        .output-section strong { color: #333; }
        #generatedTags { word-wrap: break-word; } /* For long tag lists */
    </style>
</head>
<body>
    <div class="container">
        <h1>YouTube SEO Generator</h1>

        <div>
            <label for="languageSelect">Select Language:</label>
            <select id="languageSelect">
                </select>
            
            <label for="nicheSelect">Select Niche:</label>
            <select id="nicheSelect">
                 </select>

            <button id="generateBtn">Generate SEO</button>
        </div>

        <div class="output-section">
            <h2>Generated SEO:</h2>
            <p><strong>Title:</strong> <span id="generatedTitle"></span></p>
            <p><strong>Description:</strong> <span id="generatedDescription"></span></p>
            <p><strong>Tags:</strong> <span id="generatedTags"></span></p>
        </div>
    </div>

    <script>
        const languageSelect = document.getElementById('languageSelect');
        const nicheSelect = document.getElementById('nicheSelect');
        const generateBtn = document.getElementById('generateBtn');
        const generatedTitle = document.getElementById('generatedTitle');
        const generatedDescription = document.getElementById('generatedDescription');
        const generatedTags = document.getElementById('generatedTags');

        let seoData = {}; // To store the fetched JSON data

        // Function to load languages and niches into dropdowns
        function loadUIElements() {
            // Populate language select
            for (const langCode in seoData.languages) {
                const option = document.createElement('option');
                option.value = langCode;
                option.textContent = seoData.languages[langCode];
                languageSelect.appendChild(option);
            }
            // Set default language
            languageSelect.value = 'en'; 

            // Populate niche select
            for (const niche in seoData.seo_templates) {
                const option = document.createElement('option');
                option.value = niche;
                // Format niche names for display (e.g., "food_cooking" becomes "Food Cooking")
                option.textContent = niche.replace(/_/g, ' ').replace(/\b\w/g, char => char.toUpperCase());
                nicheSelect.appendChild(option);
            }
        }

        // Function to generate SEO content
        function generateSEO() {
            const selectedLang = languageSelect.value;
            const selectedNiche = nicheSelect.value;

            if (!selectedLang || !selectedNiche) {
                alert("Please select both a language and a niche.");
                return;
            }

            const nicheTemplates = seoData.seo_templates[selectedNiche];
            let templateToUse = null;

            // For simplicity, we'll just pick the first template in the niche array.
            // In a more advanced setup, you'd have logic to pick based on keywords etc.
            if (nicheTemplates && nicheTemplates.length > 0) {
                templateToUse = nicheTemplates[0]; // Picking the first available template in the niche
            }

            // If no specific niche template is found, use the fallback
            if (!templateToUse) {
                console.warn(`No specific template found for niche: ${selectedNiche}. Using fallback.`);
                useFallback(selectedLang);
                return;
            }

            // Get the language-specific title, description, and tags from the chosen template
            let title = templateToUse.title[selectedLang] || templateToUse.title['en']; // Fallback to English
            let description = templateToUse.description[selectedLang] || templateToUse.description['en']; // Fallback to English
            let tags = templateToUse.tags[selectedLang] || templateToUse.tags['en']; // Fallback to English

            // If the template has specific variables, replace them
            if (templateToUse.variables) {
                const templateVariables = templateToUse.variables;

                for (const varName in templateVariables) {
                    if (templateVariables.hasOwnProperty(varName)) {
                        const varValues = templateVariables[varName][selectedLang] || templateVariables[varName]['en']; // Get language-specific values or English fallback
                        if (varValues && varValues.length > 0) {
                            const randomVarValue = varValues[Math.floor(Math.random() * varValues.length)];
                            const placeholder = new RegExp(`{${varName}}`, 'g'); // Create regex for placeholder e.g. {game_name}

                            title = title.replace(placeholder, randomVarValue);
                            description = description.replace(placeholder, randomVarValue);
                            // Tags is an array, so map over it to replace within each tag string
                            tags = tags.map(tag => tag.replace(placeholder, randomVarValue));
                        } else {
                            console.warn(`No values found for variable '${varName}' in language '${selectedLang}' for niche '${selectedNiche}'.`);
                        }
                    }
                }
            }

            generatedTitle.textContent = title;
            generatedDescription.textContent = description;
            generatedTags.textContent = tags.join(", "); // Display tags as comma-separated string
        }

        // Function to use fallback content
        function useFallback(lang) {
            const fallback = seoData.fallback;
            if (!fallback) {
                console.error("Fallback data not found in JSON.");
                generatedTitle.textContent = "Error generating SEO.";
                generatedDescription.textContent = "Error generating SEO.";
                generatedTags.textContent = "Error generating SEO.";
                return;
            }

            // Get fallback templates based on language, with English as ultimate fallback
            let title = fallback.title[lang] || fallback.title['en'];
            let description = fallback.description[lang] || fallback.description['en'];
            let tags = fallback.tags[lang] || fallback.tags['en'];

            // Replace variables in fallback
            if (fallback.variables) {
                for (const varName in fallback.variables) {
                    if (fallback.variables.hasOwnProperty(varName)) {
                        const varValues = fallback.variables[varName][lang] || fallback.variables[varName]['en'];
                        if (varValues && varValues.length > 0) {
                            const randomVarValue = varValues[Math.floor(Math.random() * varValues.length)];
                            const placeholder = new RegExp(`{${varName}}`, 'g'); // Generic placeholder

                            title = title.replace(placeholder, randomVarValue);
                            description = description.replace(placeholder, randomVarValue);
                            tags = tags.map(tag => tag.replace(placeholder, randomVarValue));
                        } else {
                            console.warn(`No values found for fallback variable '${varName}' in language '${lang}'.`);
                        }
                    }
                }
            }
            
            // For fallback, we need to manually provide some generic values for {topic}
            // In a real application, you might get this from user input or a default.
            const genericTopic = {
                en: "Amazing Content", hi: "अद्भुत सामग्री", ur: "حیرت انگیز مواد", ru: "Удивительный контент", es: "Contenido Asombroso", fr: "Contenu Incroyable", nl: "Geweldige Inhoud"
            }[lang] || "Amazing Content";
            
            title = title.replace(/{topic}/g, genericTopic);
            description = description.replace(/{topic}/g, genericTopic);
            tags = tags.map(tag => tag.replace(/{topic}/g, genericTopic));

            generatedTitle.textContent = title;
            generatedDescription.textContent = description;
            generatedTags.textContent = tags.join(", ");
        }


        // Event Listeners
        generateBtn.addEventListener('click', generateSEO);

        // Fetch the JSON data when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            fetch("seo-templates.json")
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status} - Could not load seo-templates.json. Make sure you are running a local server.`);
                    }
                    return response.json();
                })
                .then(data => {
                    seoData = data; // Store the data globally
                    loadUIElements(); // Populate dropdowns
                    generateSEO(); // Generate initial SEO on load
                })
                .catch(error => {
                    console.error("Error fetching or processing SEO templates:", error);
                    generatedTitle.textContent = "Error: Could not load data.";
                    generatedDescription.textContent = "Please ensure 'seo-templates.json' is in the correct path and your environment supports fetching local files (e.g., using a local server).";
                    generatedTags.textContent = "";
                });
        });

    </script>
</body>
</html>
